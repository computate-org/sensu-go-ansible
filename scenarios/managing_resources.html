

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Managing Sensu Go Resources &mdash; Sensu Go Ansible Collection  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Monitoring hosts" href="monitoring_hosts.html" />
    <link rel="prev" title="Installing Sensu Go Backend" href="installing_backend.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Sensu Go Ansible Collection
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Using Sensu Go Ansible Collection</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Scenario guides</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../scenarios.html">Scenario guides</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="installing_backend.html">Installing Sensu Go Backend</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Managing Sensu Go Resources</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#executing-tasks">Executing tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#writing-playbooks-that-manage-resources">Writing playbooks that manage resources</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="monitoring_hosts.html">Monitoring hosts</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../roles.html">Roles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Modules</a></li>
</ul>
<p class="caption"><span class="caption-text">Hacker's guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hacking.html">Developing Sensu Go Ansible Collection</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release notes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Sensu Go Ansible Collection</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../scenarios.html">Scenario guides</a> &raquo;</li>
        
      <li>Managing Sensu Go Resources</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/sensu/sensu-go-ansible/blob/master/docs/source/scenarios/managing_resources.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="managing-sensu-go-resources">
<h1>Managing Sensu Go Resources<a class="headerlink" href="#managing-sensu-go-resources" title="Permalink to this headline">¶</a></h1>
<p>Sensu Go Ansible collection contains quite a few modules for handling the
resources. But because they are doing their job by calling a web API instead
of directly manipulating the managed node, their use pattern is a bit
different from the regular Ansible module.</p>
<p>So let us start with a short introduction into how Ansible does its job.</p>
<div class="section" id="executing-tasks">
<h2>Executing tasks<a class="headerlink" href="#executing-tasks" title="Permalink to this headline">¶</a></h2>
<p>When we talk about Ansible, we usually assume that we have one <strong>control
node</strong> and one or more <strong>managed nodes</strong>. A control node is just fancy talk
for a system with Ansible installed. A managed node is usually a computer or a
virtual machine that Ansible connects to and modifies in one way or another.
We list our managed nodes in the inventory file and reference them using the
<em>hosts</em> playbook parameter.</p>
<p>When we execute the <code class="docutils literal notranslate"><span class="pre">ansible-playbook</span></code> command on the control node, Ansible
packages each task into a ball of python code (also called AnsiballZ), copies
the sources to the managed node, and executes them. This execution then
modifies the node and reports the changes back to the control node.</p>
<div class="figure align-default" id="id1">
<img alt="Diagram of a normal task execution." src="../_images/normal_execution.svg" /><p class="caption"><span class="caption-text">Diagram of a normal Ansible task execution.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>But when modules are interacting with the web API, the node modification
process is replaced by the call to the external API. We must include all
parameters for this API call (like API host, credentials, etc.) in the task
definition. The managed node in this situation only serves as a temporary jump
host.</p>
<div class="figure align-default" id="id2">
<img alt="Diagram of a web request task execution." src="../_images/web_request_execution.svg" /><p class="caption"><span class="caption-text">Diagram of a web request task execution.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p>And while this kind of functionality is indeed required sometimes, most of the
time, we can make those web API calls directly from the control node. All we
need to do is set the <em>hosts</em> playbook parameter to <code class="docutils literal notranslate"><span class="pre">localhost</span></code> and drop the
inventory file since we do not need it anymore. Do note that Ansible is still
creating an AnsiballZ, but instead of copying it to the managed node, it just
makes a local copy on the control node.</p>
<div class="figure align-default" id="id3">
<img alt="Diagram of a web request task execution on localhost." src="../_images/web_request_localhost.svg" /><p class="caption"><span class="caption-text">Diagram of a web request task execution on localhost.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>
<p>Now we can start managing resources for real.</p>
</div>
<div class="section" id="writing-playbooks-that-manage-resources">
<h2>Writing playbooks that manage resources<a class="headerlink" href="#writing-playbooks-that-manage-resources" title="Permalink to this headline">¶</a></h2>
<p>The most basic playbook for making sure <code class="docutils literal notranslate"><span class="pre">sensu/monitoring-plugins</span></code> asset is
present on the backend would look like this:</p>
<p>TODO: Add playbook for assets here.</p>
<p>Note that this playbook does not blindly add a new asset.</p>
<p>TODO: Explain idempotency.
TODO: Show using environment variables.
TODO: Show how to run the playbook.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="monitoring_hosts.html" class="btn btn-neutral float-right" title="Monitoring hosts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installing_backend.html" class="btn btn-neutral float-left" title="Installing Sensu Go Backend" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, XLAB Steampunk

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>