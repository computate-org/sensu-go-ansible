

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Versioning Sensu Go installation &mdash; Sensu Go Ansible Collection  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Updating playbooks for Sensu Go 6" href="sensu_go_5_6_migration.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Sensu Go Ansible Collection
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Using Sensu Go Ansible Collection</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart-sensu-go-6.html">Quickstart for Sensu Go 6</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart-sensu-go-5.html">Quickstart for Sensu Go 5</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Guides</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Versioning Sensu Go installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#initial-install">Initial install</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updating-existing-installation">Updating existing installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#downgrading-versions">Downgrading versions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sensu_go_5_6_migration.html">Updating playbooks for Sensu Go 6</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="roles.html">Roles</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Modules</a></li>
</ul>
<p class="caption"><span class="caption-text">Hacker's guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hacking.html">Developing Sensu Go Ansible Collection</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="release_policy.html">Release policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release notes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Sensu Go Ansible Collection</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Versioning Sensu Go installation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/sensu/sensu-go-ansible/blob/master/docs/source/versioning_sensu_go_installation.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="versioning-sensu-go-installation">
<h1>Versioning Sensu Go installation<a class="headerlink" href="#versioning-sensu-go-installation" title="Permalink to this headline">¶</a></h1>
<p>When dealing with software installation, we want to pin the versions of our
components as tightly as possible. In the first part of this guide, we will
look at how we can pin the Sensu Go version when using Ansible. We will focus
our attention on updates in the second part of this guide.</p>
<div class="section" id="initial-install">
<h2>Initial install<a class="headerlink" href="#initial-install" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="roles/backend.html"><span class="doc">backend</span></a> and <a class="reference internal" href="roles/agent.html"><span class="doc">agent</span></a> roles both
use the <a class="reference internal" href="roles/install.html"><span class="doc">install</span></a> role for installing required
components. And the installation Ansible role consults three variables when
determining what component version to install: <strong>version</strong>, <strong>build</strong>, and
<strong>channel</strong>.</p>
<p>In the vast majority of scenarios, we can set the <strong>version</strong> variable and
leave the build and channel variables set to their default values:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Install, configure and run Sensu agents</span>
  <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">agents</span>
  <span class="nt">become</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
  <span class="nt">tasks</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Install agent</span>
      <span class="nt">include_role</span><span class="p">:</span>
        <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sensu.sensu_go.agent</span>
      <span class="nt">vars</span><span class="p">:</span>
        <span class="nt">version</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">6.1.4</span>
</pre></div>
</div>
<p>When we run the previous playbook, Ansible will install the latest 6.1.4
version build from the <a class="reference external" href="https://packagecloud.io/sensu/stable">stable channel</a>. And since stable channel only
contains one package build per released version, we pinned down the Sensu Go
version to a single package.</p>
<p>Unstable versions of Sensu Go can have more than one build associated with
them. In scenarios where we are dealing with prerelease versions, we can use
the <strong>build</strong> variable to make installation predictable or use an older
package build:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Install, configure and run Sensu agents</span>
  <span class="nt">hosts</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">agents</span>
  <span class="nt">become</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
  <span class="nt">tasks</span><span class="p">:</span>
    <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Install agent</span>
      <span class="nt">include_role</span><span class="p">:</span>
        <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">sensu.sensu_go.agent</span>
      <span class="nt">vars</span><span class="p">:</span>
        <span class="nt">channel</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">testing</span>
        <span class="nt">version</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">6.2.0</span>
        <span class="nt">build</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">3881</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The installation role ignores both the <strong>channel</strong> and the <strong>build</strong>
variables values when installing the Sensu Go agent on Windows. For the
time being, Windows users can only install stable versions with the Sensu
Go agent role.</p>
</div>
<p>We can also install the latest available version if we omit the version
variable or set it to <code class="docutils literal notranslate"><span class="pre">latest</span></code>. But we strongly advise against this approach
since we may inadvertently update our Sensu Go version when all we wanted to
do is update our configuration file.</p>
</div>
<div class="section" id="updating-existing-installation">
<h2>Updating existing installation<a class="headerlink" href="#updating-existing-installation" title="Permalink to this headline">¶</a></h2>
<p>If you think updating our Sensu Go installation is as simple as bumping the
version number and rerunning the playbook, you are almost right. Ansible will
update and restart the updated Sensu Go backend or agent services, but it will
not run any version-specific migration tasks.</p>
<p>Thankfully, for most updates, restarting services is all that is needed. For
the rest of the cases, update instructions are usually straightforward. You
can find them all in the <a class="reference external" href="https://docs.sensu.io/sensu-go/latest/operations/maintain-sensu/upgrade/">Sensu Go documentation</a>.</p>
</div>
<div class="section" id="downgrading-versions">
<h2>Downgrading versions<a class="headerlink" href="#downgrading-versions" title="Permalink to this headline">¶</a></h2>
<p>The Sensu Go Ansible Collection does not support downgrades. You might be able
to install an older version of Sensu Go, but there are no guarantees that your
installation will still work.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="sensu_go_5_6_migration.html" class="btn btn-neutral float-right" title="Updating playbooks for Sensu Go 6" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2019, XLAB Steampunk.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>